# Ultralytics ðŸš€ AGPL-3.0 License - https://ultralytics.com/license
# Global configuration YAML with settings and hyperparameters for YOLO training, validation, prediction and export
# For documentation see https://docs.ultralytics.com/usage/cfg/

# ch: 1 #æŠ¥é”™

task: classify # (str) YOLO task, i.e. detect, segment, classify, pose, obb
mode: train # (str) YOLO mode, i.e. train, val, predict, export, track, benchmark

# Train settings -------------------------------------------------------------------------------------------------------
model: # (str, optional) path to model file, i.e. yolov8n.pt or yolov8n.yaml
data: "/data/users/lxing/File/medicalImg/CAS/selected_folders/plaque/dataset" # (str, optional) path to data file, i.e. coco8.yaml
epochs: 300 # (int) number of epochs to train for
time: # (float, optional) max hours to train; overrides epochs if set
patience: 100 # (int) early stop after N epochs without val improvement
batch: -1 # (int) batch size; use -1 for AutoBatch
imgsz: 256 # (int | list) train/val use int (square); predict/export may use [h,w]
save: True # (bool) save train checkpoints and predict results
save_period: -1 # (int) save checkpoint every N epochs; disabled if < 1
# cache: False # (bool | str) cache images in RAM (True/'ram') or on 'disk' to speed dataloading; False disables
cache: True
device: -1 # (int | str | list) device: 0 or [0,1,2,3] for CUDA, 'cpu'/'mps', or -1/[-1,-1] to auto-select idle GPUs
workers: 8 # (int) dataloader workers (per RANK if DDP)DDPï¼ˆDistributed Data Parallelï¼Œåˆ†å¸ƒå¼æ•°æ®å¹¶è¡Œï¼‰
project: "runs/classify/plaque240" # (str, optional) project name for results root
name: # (str, optional) experiment name; results in 'project/name'
exist_ok: False # (bool) overwrite existing 'project/name' if True
pretrained: True # (bool | str) use pretrained weights (bool) or load weights from path (str)
optimizer: auto # (str) optimizer: SGD, Adam, Adamax, AdamW, NAdam, RAdam, RMSProp, or auto
verbose: True # (bool) print verbose logs during training/val
seed: 0 # (int) random seed for reproducibility
deterministic: True # (bool) enable deterministic ops; reproducible but may be slower
#deterministic: True ä¼šé™ä½Žè®­ç»ƒé€Ÿåº¦ï¼Œä»¥ç¡®ä¿æ¯æ¬¡è¿è¡Œéƒ½èƒ½å¾—åˆ°å®Œå…¨ç›¸åŒçš„å¯å¤çŽ°ç»“æžœã€‚é€Ÿåº¦ä¸‹é™çš„å¹…åº¦å› æ¨¡åž‹ã€ç¡¬ä»¶å’Œå…·ä½“æ“ä½œè€Œå¼‚ï¼Œä½†é€šå¸¸æ˜¯å¯å¯Ÿè§‰çš„ï¼ˆä¾‹å¦‚ï¼Œé™ä½Ž 5% åˆ° 30% ç”šè‡³æ›´å¤šï¼‰
single_cls: False # (bool) treat all classes as a single class
rect: False # (bool) rectangular batches for train; rectangular batching for val when mode='val'
# rect: True #å¯ç”¨æœ€å°å¡«å……ç­–ç•¥â€”æ‰¹å¤„ç†ä¸­çš„å›¾åƒè¢«æœ€å°å¡«å……ä»¥è¾¾åˆ°é€šç”¨å¤§å°ï¼Œæœ€é•¿çš„è¾¹ç­‰äºŽimgszã€‚å¯ä»¥æé«˜æ•ˆçŽ‡å’Œé€Ÿåº¦ï¼Œä½†å¯èƒ½ä¼šå½±å“æ¨¡åž‹çš„å‡†ç¡®æ€§ã€‚
# TODO
# cos_lr: False # (bool) cosine learning rate scheduler
cos_lr: True
resume: False # (bool) resume training from last checkpoint in the run dir
amp: True # (bool) Automatic Mixed Precision (AMP) training; True runs AMP capability check
fraction: 1.0 # (float) fraction of training dataset to use (1.0 = all)
profile: False # (bool) profile ONNX/TensorRT speeds during training for loggers
freeze: # (int | list, optional) freeze first N layers (int) or specific layer indices (list)
multi_scale: False # (bool) multiscale training by varying image size é€šè¿‡æ”¹å˜å›¾åƒå°ºå¯¸è¿›è¡Œå¤šå°ºåº¦è®­ç»ƒ
compile: False # (bool | str) enable torch.compile() backend='inductor'; True="default", False=off, or "default|reduce-overhead|max-autotune-no-cudagraphs"

# Classification
# TODO
dropout: 0.3 # (float) dropout for classification head (classify only)

# Val/Test settings ----------------------------------------------------------------------------------------------------
val: True # (bool) run validation/testing during training
split: val # (str) dataset split to evaluate: 'val', 'test' or 'train'
save_json: False # (bool) save results to COCO JSON for external evaluation
conf: # (float, optional) confidence threshold; defaults: predict=0.25, val=0.001
# TODO
iou: 0.7 # (float) IoU threshold used for NMS
max_det: 300 # (int) maximum number of detections per image
half: False # (bool) use half precision (FP16) if supported
dnn: False # (bool) use OpenCV DNN for ONNX inference
plots: True # (bool) save plots and images during train/val

# Predict settings -----------------------------------------------------------------------------------------------------
source: # (str, optional) path/dir/URL/stream for images or videos; e.g. 'ultralytics/assets' or '0' for webcam
vid_stride: 1 # (int) read every Nth frame for video sources
stream_buffer: False # (bool) True buffers all frames; False keeps the most recent frame for low-latency streams
visualize: True # (bool) visualize model features (predict) or TP/FP/FN confusion (val)
augment: False # (bool) apply test-time augmentation during prediction
agnostic_nms: False # (bool) class-agnostic NMS
classes: # (int | list[int], optional) filter by class id(s), e.g. 0 or [0,2,3]
retina_masks: False # (bool) use high-resolution segmentation masks (segment)
embed: # (list[int], optional) return feature embeddings from given layer indices

# Visualize settings ---------------------------------------------------------------------------------------------------
show: True # (bool) show images/videos in a window if supported
save_frames: False # (bool) save individual frames from video predictions
save_txt: True # (bool) save results as .txt files (xywh format)
save_conf: True # (bool) save confidence scores with results
save_crop: False # (bool) save cropped prediction regions to files
show_labels: True # (bool) draw class labels on images, e.g. 'person'
show_conf: True # (bool) draw confidence values on images, e.g. '0.99'
show_boxes: True # (bool) draw bounding boxes on images
line_width: # (int, optional) line width of boxes; auto-scales with image size if not set

# Hyperparameters ------------------------------------------------------------------------------------------------------
lr0: 0.01 # (float) initial learning rate (SGD=1e-2, Adam/AdamW=1e-3)
lrf: 0.01 # (float) final LR fraction; final LR = lr0 * lrf
momentum: 0.937 # (float) SGD momentum or Adam beta1
# TODO
weight_decay: 0.0005 # (float) weight decay (L2 regularization)
warmup_epochs: 3.0 # (float) warmup epochs (fractions allowed)
warmup_momentum: 0.8 # (float) initial momentum during warmup
warmup_bias_lr: 0.1 # (float) bias learning rate during warmup
box: 7.5 # (float) box loss gain
#åœ¨å½“å‰äºŒåˆ†ç±»/çº¯åˆ†ç±»è®­ç»ƒé‡Œï¼Œcls è¶…å‚ä¸èµ·ä½œç”¨ã€‚v8ClassificationLoss ç›´æŽ¥ç”¨ F.cross_entropy è¿”å›žå•ä¸€æŸå¤±ï¼Œå¹¶æœªä¹˜ä»¥ cls å¢žç›Šï¼›cls åªåœ¨æ£€æµ‹/å¤šä»»åŠ¡æ—¶ç”¨äºŽå¹³è¡¡åˆ†ç±»åˆ†æ”¯ã€‚ä¿ç•™åœ¨ YAML ä»…ä¸ºå…¼å®¹ï¼Œå®žè´¨ä¸ç”Ÿæ•ˆã€‚å¦‚éœ€è°ƒèŠ‚åˆ†ç±»æŸå¤±æƒé‡ï¼Œéœ€è¦åœ¨è¯¥ loss ç±»ä¸­æ‰‹åŠ¨ä¹˜ä»¥ç³»æ•°ã€‚
cls: 0.5 # (float) classification loss gain #åˆ†ç±»ä»»åŠ¡ä¸é€‚ç”¨
dfl: 1.5 # (float) distribution focal loss gain
pose: 12.0 # (float) pose loss gain (pose tasks)
kobj: 1.0 # (float) keypoint objectness loss gain (pose tasks)
nbs: 64 # (int) nominal batch size used for loss normalization

#https://docs.ultralytics.com/usage/cfg/#augmentation-settings
#https://docs.ultralytics.com/reference/data/augment/
hsv_h: 0.015 # (float) HSV hue augmentation fraction  #æ”¯æŒåˆ†ç±»ä»»åŠ¡
hsv_s: 0.7 # (float) HSV saturation augmentation fraction #æ”¯æŒåˆ†ç±»ä»»åŠ¡
hsv_v: 0.4 # (float) HSV value (brightness) augmentation fraction #æ”¯æŒåˆ†ç±»ä»»åŠ¡

# flipud: 0.0 # (float) vertical flip probability #æ”¯æŒåˆ†ç±»ä»»åŠ¡
flipud: 0.5
# fliplr: 0.5 # (float) horizontal flip probability #æ”¯æŒåˆ†ç±»ä»»åŠ¡
fliplr: 0.5

# auto_augment ã€erasingä»…æ”¯æŒåˆ†ç±»ä»»åŠ¡ 
#https://docs.ultralytics.com/guides/yolo-data-augmentation/#classification-specific-augmentations
auto_augment: randaugment # (str) classification auto augmentation policy: randaugment, autoaugment, augmix
# Supported Tasks classify. Applies a predefined augmentation policy ('randaugment', 'autoaugment', or 'augmix') to enhance model performance through visual diversity.Setting to None disables automated augmentation.
# auto_augment: 
# erasing: 0.4 # (float) random erasing probability for classification (0â€“0.9), <1.0
# erasing: 0.9
erasing: 0.0
# Custom config.yaml ---------------------------------------------------------------------------------------------------
cfg: # (str, optional) path to a config.yaml that overrides defaults

# Tracker settings ------------------------------------------------------------------------------------------------------
tracker: botsort.yaml # (str) tracker config file: botsort.yaml or bytetrack.yaml
